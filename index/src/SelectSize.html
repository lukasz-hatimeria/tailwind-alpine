<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>

    <link href="../dist/output.css" rel="stylesheet" />
    <script defer src="https://unpkg.com/alpinejs@3.x.x/dist/cdn.min.js"></script>
</head>

<body>
    <div class="mt-6 ml-6 left-0 items-center" x-data="manageButtons()">
        <p>
            <div class="relative text-my-grey max-w-150 h-10 flex items-center justify-between cursor-pointer" @click="openSidebar()">
                <span x-text="selectedSize"></span>
                <span>></span>
                <span class="absolute border border-my-grey max-w-50 min-w-150 mt-5"></span>
            </div>
        </p>
        <p class=" mt-2 ">
            <button class="border-solid pl-5 pr-5 pt-2 pb-2 bg-my-yellow text-xs font-bold mr-2 text-white " @click="openAddItem()">
                Dodaj do koszyka
            </button>
        </p>

        <!-- Select Size modal -->
        <div class=" absolute top-0 left-0 flex items-center justify-center w-full h-full bg-my-grey " x-show="sidebar">
            <div class=" absolute top-0 right-0 flex  w-2/5 h-full bg-my-white " @click.away="closeBackground() ">
                <div x-data=" manageSizes() " x-init=" fetchSizes() ">
                    <template x-if=" products !==null ">
                        <div class=" ">
                            <span class=" top-24 absolute border-b-2 border-my-light-grey w-full "> </span>
                            <div class=" absolute top-5 left-10 right-10 bottom-10 w-fill h-fill ">
                                <div class="mb-12 flex justify-between ">
                                    <h1 class=" font-bold mb-12 "> Wybierz Rozmiar</h1>
                                    <span @click="closeBackground() " class="cursor-pointer">X</span>
                                </div>
                                <template x-for=" single in products.data ">
                                    <div class=" relative min-h-100 hover:bg-my-light-grey "
                                        @click=" chooseSize ( single.size) ">
                                        <div class=" absolute bottom-1/2 translate-y-2/4 w-full ">
                                            <span class="ml-2" x-text=" single.size "></span>
                                        </div>
                                        <div class=" border-b absolute top-full border-my-light-grey w-full "></div>
                                    </div>
                                </template>
                    <div class=" mt-12 ">
                        <span class=" text-xs ">Nie masz pewności, które wybrać?</span>
                        <span class=" text-xs underline font-bold ">Sprawdź tabele rozmiarów</span>
                    </div>
                </div>
            </div>
            </template>
        </div>
    </div>


    </div>
    <!-- Add Item modal -->
    <div class=" absolute top-0 left-0 flex items-center justify-center w-full h-full bg-my-grey overflow-scroll	 " x-show=" open ">
        <div class=" min-w-600 max-w-600 bg-my-white rounded shadow-xl 	" @click.away=" closeBackground() ">
            <div class=" pl-10 pr-10 pb-5 ">
                <div class=" relative font-bold mb-4 ">
                    <p class=" absolute right-0 top-1 cursor-pointer " @click=" closeBackground() ">X</p>


                    <h1 class=" pt-3 font-bold text-lg ">Produkt dodany do koszyka</h1>
                </div>
                <div class=" flex justify-start ">
                    <img class=" object-cover object-center h-64 w-48 " src=" https://img.modivo.cloud/product(9/d/0/d/9d0d28f1583992e8499565085b46af59b834ed1d_1_5059404361403.jpg,jpg)/dare2b-kurtka-puchowa-reputable-dwn379-rozowy-slim-fit.jpg
                " alt=" Girl in a jacket " width=" 500 " height=" 600 " />
                    <div class=" ml-5 mt-3 w-full ">
                        <h2 class=" font-bold ">Dare2b</h2>
                        <span class=" text-xs font-normal ">Kurtka puchowa Reputable DWN379 Różowy Slim Fit
                            </span>
                        <p>
                            <span class=" text-xs font-normal text-gray-400 line-through ">599,00 zł</span>
                            <span class=" text-xs font-normal text-gray-400 "> |</span>
                            <span class=" text-xs font-normal ">-62%</span>
                            <span class=" text-sm font-bold text-red-700 ">229,0 zł</span>
                        </p>

                        <div class=" mt-5 ">
                            <span class=" text-xs font-bold ">Rozmiar: </span>
                            <span class=" text-xs font-normal ">14</span>
                            <p class=" text-xs font-bold ">
                                Kolor: <span class=" text-xs font-normal ">Różowy</span>
                            </p>
                        </div>
                        <div class=" mt-9 flex justify-between ">
                            <button class=" border-solid border border-black pl-5 pr-5 pt-2 pb-2 bg-white text-xs font-bold ">
                                    Kontynuuj Zakupy
                                </button>
                            <button class=" border-solid pl-5 pr-5 pt-2 pb-2 bg-my-yellow text-xs font-bold mr-2 text-white ">
                                    Pokaż Koszyk
                                </button>
                        </div>
                    </div>
                </div>
            </div>
            <div class=" pl-10 pr-10 pb-5 ">
                <svg class=" inline " data-v-0b83b9ec=" " data-v-ae8a71a8=" " xmlns=" http://www.w3.org/2000/svg " width=" 1.5rem " height=" 1.5rem " role=" presentation " class=" svg ">
                        <g data-v-0b83b9ec=" " fill=" #222222 " stroke=" currentColor ">
                            <svg data-v-ae8a71a8=" " data-v-0b83b9ec=" " xmlns=" http://www.w3.org/2000/svg "
                                viewBox=" 0 0 24 24 " stroke=" none " class=" svg-icon ">
                                <path data-v-ae8a71a8=" " data-v-0b83b9ec=" "
                                    d=" M12 1L2 6v12.32L12 23l10-4.69V6L12 1zM5.23 8l1.99 5.28L9.34 8l1.1 6.45h-.9l-.6-3.1L7.21 16l-1.69-4.65-.61 3.1H4L5.23 8zm6.28.3h3.4l-.34.85H12.4v1.7h1.52l-.34.88H12.4v2.73h-.88V8.3zm6.62 0c1.14 0 2.1.55 2.63 1.4l-.85.32a2.11
                2.11 0 00-1.78-.89c-1.28 0-2.19.93-2.19 2.25 0 1.31.91 2.24 2.19 2.24.77 0 1.4-.34 1.79-.9l.85.31a3.03 3.03 0 01-2.64 1.43 3.01 3.01 0 01-3.1-3.08 3.02 3.02 0 013.1-3.08z ">
                                </path>
                            </svg>
                </g>
                </svg>
                <span class=" text-xs ">W MODIVO FASHION CLUB możesz otrzymać
                    </span>
                <span class=" font-bold text-xs ">229 MODIVO Points</span>
                <span class=" text-xs ">
                        za ten produkt. Zarejestruj się i odblokuj dodatkowe
                        korzyści.</span>
                <span class=" text-xs underline ">Dowiedz się więcej</span>

                <!-- slider -->

                <div x-data=" manageItems() " x-init=" getProducts() ">
                    <template x-if=" fetchedProducts !==null ">
                            <div class=" relative ">
                                <button
                                    class=" absolute right-0 top-10 rounded-full w-10 h-10 backdrop-blur-sm bg-white/30 border border-white "
                                    x-on:click=" add() " x-show=" productIndex !==3 ">
                                    <span class=" backdrop-blur ">></span>
                                </button>
                                <button
                                    class=" absolute left-0 top-10 rounded-full w-10 h-10 backdrop-blur-sm bg-white/30 border border-white "
                                    x-on:click=" remove() " x-show=" productIndex !==0 ">
                                    < </button> <div class=" pt-5 ">
                            </div>

                            <div class=" grid gap-4 grid-cols-3 min-h-200 max-h-200 ">
                                <template x-for=" product in slicedProducts ">
                                    <div>
                                        <img class=" mx-auto object-cover object-center min-h-100 max-h-100 "
                                            :src=" product.image " alt=" cool item " />
                                        <span class=" inline-block text-sm " x-text=" product.title "></span>
                                    </div>

                                </template>
                </div>
                <button class=" flex mx-auto border-solid border border-black pl-5 pr-5 pt-2 pb-2 bg-white text-xs font-bold min-w-150 " x-on:click=" perSlide=perSlide===1 ? 3 : 1 ">
                                Amount per slide: <span x-text=" perSlide "></span>
                            </button>
            </div>
        </div>
        </template>
    </div>
    </div>
    </div>

</body>
<script>
    function manageSizes() {
        return {
            products: null,
            fetchSizes() {
                (async() => {
                    const response = await fetch('./data.json')
                    this.products = await response.json()

                    console.log(this.products)
                })()
            },
        }
    }

    function manageButtons() {
        return {
            open: false,
            sidebar: false,
            selectedSize: " Select Size: ",
            openAddItem() {
                if (this.selectedSize === " Select Size: ") {
                    this.open = false;
                    this.sidebar = true;
                } else {
                    this.open = true;
                    this.sidebar = false;
                }
            },
            openSidebar() {
                this.open = false;
                this.sidebar = true;
            },
            closeBackground() {
                this.open = false;
                this.sidebar = false;
            },
            chooseSize(size) {
                this.selectedSize = " Select Size: " + size;
                this.sidebar = false;
            }
        }
    }

    function manageItems() {
        return {
            productIndex: 0,
            perSlide: 1,
            fetchedProducts: null,
            slicedProducts: null,
            add() {
                if (this.productIndex < 3) {
                    this.productIndex += this.perSlide;
                }
                if (this.productIndex >= 3) {
                    this.productIndex = 3
                    this.slicedProducts = this.fetchedProducts.slice(3, 6)
                } else {
                    this.slicedProducts = this.fetchedProducts.slice(this.productIndex, this.productIndex + 3)
                }
            },
            remove() {
                if (this.productIndex > 0) {
                    this.productIndex -= this.perSlide
                }
                if (this.productIndex <= 2 && this.perSlide === 3) {
                    this.productIndex = 0
                    this.slicedProducts = this.fetchedProducts.slice(0, 3)
                } else {
                    this.slicedProducts = this.fetchedProducts.slice(this.productIndex, this.productIndex + 3)
                }
            },
            getProducts() {
                (async() => {
                    const response = await fetch('https://fakestoreapi.com/products?limit=6')
                    if (!response.ok)
                        alert(`Something went wrong: ${response.status} - ${response.statusText}`)
                    this.fetchedProducts = await response.json()
                    this.slicedProducts = this.fetchedProducts.slice(0, 3)
                })()
            }
        }
    }
</script>